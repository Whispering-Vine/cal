<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Event List - Whispering Vine Wine Co.</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Tag Manager -->
  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T57JWWVK');
  </script>
  <!-- End Google Tag Manager -->
  <style>
    :root {
      --background: #f8f9fa;
      --foreground: #1f2937;
      --muted: #e5e7eb;
    }
    .bg-background { background-color: var(--background); }
    .text-foreground { color: var(--foreground); }
    .bg-muted { background-color: var(--muted); }
  </style>
</head>
<body class="bg-background text-foreground">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T57JWWVK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <div class="container mx-auto max-w-3xl px-4 py-10">
    <div class="flex justify-center mb-8">
      <a href="https://wvwine.co"><img src="logo.png" alt="Whispering Vine Wine Co. Logo" class="h-16"></a>
    </div>
    <h1 class="text-center text-2xl font-semibold mb-6">Upcoming Events</h1>
    <ul id="event-list" class="space-y-6 hidden"></ul>
    <ul id="skeleton-list" class="space-y-6">
      <li class="space-y-2 animate-pulse">
        <div class="h-6 bg-muted rounded"></div>
        <div class="h-4 bg-muted rounded w-1/2"></div>
        <div class="h-4 bg-muted rounded w-1/3"></div>
      </li>
      <li class="space-y-2 animate-pulse">
        <div class="h-6 bg-muted rounded"></div>
        <div class="h-4 bg-muted rounded w-1/2"></div>
        <div class="h-4 bg-muted rounded w-1/3"></div>
      </li>
      <li class="space-y-2 animate-pulse">
        <div class="h-6 bg-muted rounded"></div>
        <div class="h-4 bg-muted rounded w-1/2"></div>
        <div class="h-4 bg-muted rounded w-1/3"></div>
      </li>
    </ul>
  </div>
  <script>
    const formatDate = (dateTime) => {
      const date = new Date(dateTime);
      const options = { weekday: 'long', month: 'short', day: 'numeric' };
      return date.toLocaleDateString('en-US', options);
    };
    const formatTime = (dateTime) => {
      const date = new Date(dateTime);
      return date.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
    };
    const displayEvents = async () => {
      try {
        const response = await fetch('https://cal.wvwine.co/events.json');
        if (!response.ok) throw new Error('Unable to fetch events');
        const events = await response.json();
        const now = new Date();
        const upcomingEvents = events.filter(e => new Date(e.endTime) > now);
        upcomingEvents.sort((a, b) => new Date(a.startTime) - new Date(b.startTime));
        const eventList = document.getElementById('event-list');
        eventList.innerHTML = '';
        upcomingEvents.forEach(event => {
          const item = document.createElement('li');
          item.className = 'p-6 rounded-lg shadow bg-white';
          item.innerHTML = `
            <a href="https://cal.wvwine.co/${event.id}" class="block space-y-1">
              <h2 class="text-lg font-semibold">${event.title}</h2>
              <div class="text-sm text-gray-500">${formatDate(event.startTime)}</div>
              <div class="text-sm text-gray-500">${formatTime(event.startTime)} - ${formatTime(event.endTime)}</div>
              <div class="text-sm text-gray-500">${event.location}</div>
            </a>`;
          eventList.appendChild(item);
        });
        document.getElementById('skeleton-list').style.display = 'none';
        eventList.classList.remove('hidden');
      } catch (error) {
        console.error('Error displaying events:', error);
      }
    };
    document.addEventListener('DOMContentLoaded', displayEvents);
  </script>
</body>
</html>
